windows_qt515_static:
  stage: build
  image: kdeorg/ci-windows-qt515:latest
  tags:
    - Windows
  variables:
    KDECI_CACHE_PATH: C:/Gitlab/Artifacts/windows-qt5.15-static/
    KDECI_GITLAB_SERVER: https://invent.kde.org/
    KDECI_PACKAGE_PROJECT: teams/ci-artifacts/windows-qt5.15-static
    CRAFT_ROOT: C:/Craft/windows-msvc2019_64-cl/
    CXX: cl.exe
    CC: cl.exe
    PYTHONUTF8: 1
  interruptible: true
  before_script:
    - git clone https://invent.kde.org/sysadmin/ci-utilities
    - git clone https://invent.kde.org/sysadmin/repo-metadata ci-utilities/repo-metadata/
  script:
    - . ci-utilities/resources/setup-msvc-env.ps1
    - python -u ci-utilities/run-ci-build.py --project $CI_PROJECT_NAME --branch $CI_COMMIT_REF_NAME --extra-cmake-args=-DBUILD_SHARED_LIBS=OFF --platform Windows
